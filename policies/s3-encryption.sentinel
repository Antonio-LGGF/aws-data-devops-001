
# S3 Bucket Encryption Policy
# Ensures that all S3 buckets have server-side encryption enabled.

policy "s3-encryption" {
  import "tfplan/v2" as tfplan

  main = rule {
    all tfplan.resource_changes as resource {
      resource.type is "aws_s3_bucket" and
      resource.mode is "managed" and
      resource.change.after.server_side_encryption_configuration is not null
    }
  }
}
