
# Resource Tagging Policy
# Ensures that every managed resource has required tags: Environment, Owner, and Project.

policy "resource-tagging" {
  import "tfplan/v2" as tfplan

  main = rule {
    all tfplan.resource_changes as resource {
      resource.mode is "managed" and
      all resource.change.after as after {
        after.tags is not null and
        "Environment" in after.tags and
        "Owner" in after.tags and
        "Project" in after.tags
      }
    }
  }
}
